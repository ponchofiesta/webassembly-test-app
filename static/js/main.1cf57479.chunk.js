(this["webpackJsonpwebassembly-test-app"]=this["webpackJsonpwebassembly-test-app"]||[]).push([[0],{193:function(e,t,a){e.exports=a(344)},343:function(e,t,a){},344:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),n=a(42),o=a.n(n),i=a(35),c=a(179),l=a(37),p=a(356),h=a(355),m=a(353),u=a(351),d=a(183),w=a(352),g=a(19),y=a.n(g);var v=class{constructor(){this.onLoad=()=>{},this.result=null,this.startTime=null,this.stopTime=null}run(){console.warn(this.constuctor.name+" not implemented.")}start(){this.startTime=performance.now()}stop(){this.stopTime=performance.now(),this.result=this.stopTime-this.startTime}results(){return this.result}};var f=class extends v{fibonacci(e){let t,a=0,s=1;for(;e-- >0;)t=a,a=s,s+=t;return a}run(e){console.debug("start "+this.constructor.name),super.start(),this.fibonacci(...e.parameters),super.stop(),console.debug("stop "+this.constructor.name)}};var b=class extends v{constructor(){super(),this.moves=""}hanoi(e,t,a,s){return e>0&&(this.hanoi(e-1,t,s,a),this.moves+=t+"->"+s+"\n",this.hanoi(e-1,a,t,s)),this.moves}run(e){console.debug("start "+this.constructor.name),super.start(),this.hanoi(...e.parameters),super.stop(),console.debug("stop "+this.constructor.name)}};var x=class extends v{sort(e){return e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)}run(e){console.debug("start "+this.constructor.name);let t=JSON.parse(JSON.stringify(e.externalData.data));super.start(),this.sort(t),super.stop(),console.debug("stop "+this.constructor.name)}};var E=class extends v{prime(e){let t=[];e>2&&t.push(2),e>3&&t.push(3);let a=Array(e).fill(!1);for(let s=1;s*s<e;s++)for(let t=1;t*t<e;t++){let r=4*s*s+t*t;r<=e&&(r%12===1||r%12===5)&&(a[r]^=!0),(r=3*s*s+t*t)<=e&&r%12===7&&(a[r]^=!0),r=3*s*s-t*t,s>t&&r<=e&&r%12===11&&(a[r]^=!0)}for(let s=5;s*s<e;s++)if(a[s])for(let t=s*s;t<e;t+=s*s)a[t]=!1;for(let s=5;s<e;s++)a[s]&&t.push(s);return t}run(e){console.debug("start "+this.constructor.name),this.start(),this.prime(...e.parameters),this.stop(),console.debug("stop "+this.constructor.name)}},D=a(60);var C=class extends v{aes_encrypt(e,t,a){return new D.ModeOfOperation.cbc(e,t).encrypt(a)}aes_decrypt(e,t,a){return new D.ModeOfOperation.cbc(e,t).decrypt(a)}run(e){console.debug("start "+this.constructor.name),super.start(),this.aes_encrypt(...e.parameters,e.externalData.data),super.stop(),console.debug("stop "+this.constructor.name)}},k=a(168),S=a.n(k);var j=class extends v{deflate(e){return S.a.deflate(e,{raw:!0})}run(e){console.debug("start "+this.constructor.name);let t=D.utils.utf8.toBytes(e.externalData.data);super.start(),this.deflate(t),super.stop(),console.debug("stop "+this.constructor.name)}};var A=class extends v{constructor(...e){super(...e),this.image=null,this.canvas=null,this.context=null,this.onDraw=()=>{}}async run(e){console.debug("start "+this.constructor.name),this.image=e.externalData.data,this.canvas=document.createElement("canvas"),this.canvas.width=this.image.width,this.canvas.height=this.image.height,this.context=this.canvas.getContext("2d"),this.context.drawImage(this.image,0,0),await this.onLoad(Object(i.a)({},e,{canvas:this.canvas})),super.start(),this.onDraw(),super.stop(),console.debug("stop "+this.constructor.name)}};var I=class extends A{constructor(){super(),this.convoluteFilter=(e,t)=>{const a=Math.round(Math.sqrt(e.length)),s=Math.floor(a/2),r=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),n=r.data,o=r.width,i=r.height,c=this.context.createImageData(o,i),l=c.data;for(let p=0;p<i;p++)for(let r=0;r<o;r++){const c=4*(p*o+r);let h=0,m=0,u=0;for(let t=0;t<a;t++)for(let c=0;c<a;c++){const l=p+t-s,d=r+c-s;if(l>=0&&l<i&&d>=0&&d<o){const s=4*(l*o+d),r=e[t*a+c];h+=n[s]*r,m+=n[s+1]*r,u+=n[s+2]*r}}l[c]=h*t,l[c+1]=m*t,l[c+2]=u*t,l[c+3]=n[c+3]}this.context.putImageData(c,0,0)},this.onDraw=()=>{this.convolve()}}convolve(){this.convoluteFilter([0,.2,0,.2,.2,.2,0,.2,0],1)}};var T=class extends A{constructor(){super(),this.onDraw=()=>{window.wasm.rust.convolve(this.canvas)}}};var P=class extends A{constructor(){super(),this.onDraw=()=>{const e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);e.data.set(window.wasm.go.convolve_mem(e.data,this.canvas.width,this.canvas.height)),this.context.putImageData(e,0,0)}}};var R=class extends v{constructor(e){super();const t=typeof e;if("function"!==t)throw new Error("method parameter must be a function, actually it is '"+t+"'.");this.method=e}run(e){console.debug("start "+this.constructor.name),super.start(),this.method(e),super.stop(),console.debug("stop "+this.constructor.name)}};var _=class extends v{iterate(e){let t=0;for(let a=0;a<e;++a)t+=a;return t}run(e){console.debug("start "+this.constructor.name),super.start(),this.iterate(...e.parameters),super.stop(),console.debug("stop "+this.constructor.name)}};var H=class extends v{strings_dynamic(e,t){return e.includes(t)}run(e){console.debug("start "+this.constructor.name),super.start();let t=e.parameters.slice(1);for(let a=0;a<e.parameters[0];a++)this.strings_dynamic(...t);super.stop(),console.debug("stop "+this.constructor.name)}};var L=class extends R{run(e){console.debug("start "+this.constructor.name),super.start();let t=e.parameters[0],a=e.parameters.slice(1),s=Object(i.a)({},e,{parameters:a});for(let r=0;r<t;r++)this.method(s);super.stop(),console.debug("stop "+this.constructor.name)}};var F=class extends H{run(e){console.debug("start "+this.constructor.name),super.start();for(let t=0;t<e.parameters[0];t++)super.strings_dynamic("hello world","world");super.stop(),console.debug("stop "+this.constructor.name)}};var M=class extends v{sum(e){return e.reduce((e,t)=>e+t,0)}run(e){console.debug("start "+this.constructor.name),super.start();for(let t=0;t<e.parameters[0];t++)this.sum([1,2,3,4,5,6,7,8,9]);super.stop(),console.debug("stop "+this.constructor.name)}};var O=class extends v{constructor(){super(),this.canvas=null,this.context=null,this.video=null,this.frameCount=0,this.onDraw=null}onEnd(e){super.stop(),console.debug("stop "+this.constructor.name),e()}getVideoFrame(){const e=document.createElement("canvas");e.width=this.video.videoWidth,e.height=this.video.videoHeight;const t=e.getContext("2d");return t.drawImage(this.video,0,0,e.width,e.height),t.getImageData(0,0,e.width,e.height)}renderVideo(){this.onDraw(),this.video.paused||requestAnimationFrame(this.renderVideo.bind(this))}async run(e){console.debug("start "+this.constructor.name),this.video=e.externalData.data,this.video.style="display: none;";const t=document.createElement("canvas");t.width=this.video.videoWidth,t.height=this.video.videoHeight,this.canvas=t,this.context=t.getContext("2d"),await this.onLoad(Object(i.a)({},e,{video:e.externalData.data,canvas:t}));const a=new Promise((e,t)=>{this.video.addEventListener("ended",()=>{this.onEnd(e)},!1),this.video.addEventListener("error",()=>{this.onEnd(t)},!1)});return super.start(),this.video.play(),this.renderVideo(),a}results(){return this.result=this.frameCount/(this.stopTime-this.startTime)*1e3,this.result}};var B=class extends O{constructor(){super(),super.onDraw=()=>{let e=this.getVideoFrame();e.data.set(this.convolve(e.data,this.video.videoWidth,this.video.videoHeight,[[1,1,1],[1,1,1],[1,1,1]],1/9,6)),this.context.putImageData(e,0,0),this.frameCount++}}convolve(e,t,a,s,r,n=1){const o=s.length,i=Math.floor(o/2);for(let c=0;c<n;c+=1)for(let n=1;n<a-1;n+=1)for(let a=1;a<t-1;a+=1){const c=4*(n*t+a);let l=0,p=0,h=0;for(let r=0;r<o;++r)for(let c=0;c<o;++c){const o=4*((n+(r-i))*t+(a+(c-i)));l+=e[o]*s[r][c],p+=e[o+1]*s[r][c],h+=e[o+2]*s[r][c]}e[c]=r*l,e[c+1]=r*p,e[c+2]=r*h}return e}};var W=class extends O{constructor(){super(),super.onDraw=()=>{let e=this.getVideoFrame();e.data.set(this.convolve(e.data,this.video.videoWidth,this.video.videoHeight)),this.context.putImageData(e,0,0),this.frameCount++}}convolve(e,t,a){return window.wasm.rust.convolve_video(e,this.video.videoWidth,this.video.videoHeight,1/9,6)}};var V=class extends O{constructor(){super(),super.onDraw=()=>{let e=this.getVideoFrame();e.data.set(this.convolve(e.data,this.video.videoWidth,this.video.videoHeight)),this.context.putImageData(e,0,0),this.frameCount++}}convolve(e,t,a){return e=window.wasm.go.convolve_video(e,this.canvas.width,this.canvas.height,1/9,6)}},U=a(81),q=a.n(U);var z=class extends v{sha256(e){const t=q.a.md.sha256.create();return t.update(e),t.digest().toHex()}run(e){console.debug("start "+this.constructor.name);let t="";e.externalData.data.forEach(e=>t+=String.fromCharCode(e)),this.start(),this.sha256(t),this.stop(),console.debug("stop "+this.constructor.name)}},J=a(182);var N=class extends v{async run(e){console.debug("start "+this.constructor.name),super.start();J.a.load(e.externalData.data.buffer);super.stop(),console.debug("stop "+this.constructor.name)}};var G=class extends v{dom(e){const t=document.body,a=document.createElement("div");t.appendChild(a);for(let s=0;s<e;s++){const e=document.createElement("h3");e.textContent="Header "+s;const t=document.createElement("p");t.textContent="Paragraph "+s,a.appendChild(e),a.appendChild(t)}t.removeChild(a)}run(e){console.debug("start "+this.constructor.name),super.start(),this.dom(...e.parameters),super.stop(),console.debug("stop "+this.constructor.name)}};var X=class extends v{async sha256(e){const t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(e=>("00"+e.toString(16)).slice(-2)).join("")}async run(e){console.debug("start "+this.constructor.name),this.start(),await this.sha256(e.externalData.data.buffer),this.stop(),console.debug("stop "+this.constructor.name)}};var $=class extends v{async sha512(e){const t=await crypto.subtle.digest("SHA-512",e);return Array.from(new Uint8Array(t)).map(e=>("00"+e.toString(16)).slice(-2)).join("")}async run(e){console.debug("start "+this.constructor.name),this.start(),await this.sha512(e.externalData.data.buffer),this.stop(),console.debug("stop "+this.constructor.name)}};var K=class extends v{sha512(e){const t=q.a.md.sha512.create();return t.update(e),t.digest().toHex()}run(e){console.debug("start "+this.constructor.name);let t="";e.externalData.data.forEach(e=>t+=String.fromCharCode(e)),this.start(),this.sha512(e.externalData.data),this.stop(),console.debug("stop "+this.constructor.name)}};const Q=e=>Math.round(e),Y=e=>e.toFixed(1)+" fps",Z={chart:{width:"100%",height:64,type:"bar",animations:{enabled:!1}},markers:{size:7},dataLabels:{enabled:!0,formatter:Y},xaxis:{title:{text:"Iterations"},categories:[]},yaxis:{title:{text:"Frames per second"},labels:{formatter:Y}},legend:{show:!0},title:{text:"Frame rate",align:"left"},tooltip:{y:{formatter:Y}}},ee={chart:{width:"100%",height:16,type:"line",animations:{enabled:!1}},markers:{size:7},dataLabels:{enabled:!0,formatter:Q},xaxis:{title:{text:"Iterations"},categories:[]},yaxis:{title:{text:"Duration in ms"},labels:{formatter:Q}},legend:{show:!0},title:{text:"Time taken to run the benchmarks",align:"left"},tooltip:{y:{formatter:e=>Q(e)+" ms"}}};var te={players:{js:{logo:"logos/es-ecmascript-logo.svg",color:"rgb(248,220,61)"},rust:{logo:"logos/rust-logo-blk.svg",color:"black"},go:{logo:"logos/Go-Logo_Aqua.svg",color:"#2DBCAF"}},benchmarks:[{name:"Iterate",description:"simple number iteration",runners:[{name:"Iterate 100m",type:"js",factory:()=>new _},{name:"Iterate 100m",type:"rust",factory:()=>new R(e=>window.wasm.rust.iterate(...e.parameters))},{name:"Iterate 100m",type:"go",factory:()=>new R(e=>window.wasm.go.iterate(...e.parameters))}],parameters:[1e8],repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Strings dynamic",description:"Search for substring in string",runners:[{name:"strings",type:"js",factory:()=>new H},{name:"strings",type:"rust",factory:()=>new L(e=>window.wasm.rust.strings_dynamic(...e.parameters))},{name:"strings",type:"go",factory:()=>new L(e=>window.wasm.go.strings_dynamic(...e.parameters))}],parameters:[1e4,"hello world","world"],repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Strings static",description:"Search for substring in string",runners:[{name:"strings",type:"js",factory:()=>new F},{name:"strings",type:"rust",factory:()=>new R(e=>window.wasm.rust.strings_static(...e.parameters))},{name:"strings",type:"go",factory:()=>new R(e=>window.wasm.go.strings_static(...e.parameters))}],parameters:[1e6],repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Sum static",description:"",runners:[{name:"sum",type:"js",factory:()=>new M},{name:"sum",type:"rust",factory:()=>new R(e=>window.wasm.rust.sum(...e.parameters))},{name:"sum",type:"go",factory:()=>new R(e=>window.wasm.go.sum(...e.parameters))}],parameters:[1e6],repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Fibonacci sequence",description:"Calculate the Fibonacci sequence for a given N",runners:[{name:"Iterative 100m",type:"js",factory:()=>new f},{name:"Iterative 100m",type:"rust",factory:()=>new R(e=>window.wasm.rust.fibonacci(...e.parameters))},{name:"Iterative 100m",type:"go",factory:()=>new R(e=>window.wasm.go.fibonacci(...e.parameters))}],parameters:[1e8],repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Towers of Hanoi",description:"Move all disks from one tower to another and return the used moves as string",runners:[{name:"Recursive 20",type:"js",factory:()=>new b},{name:"Recursive 20",type:"rust",factory:()=>new R(e=>window.wasm.rust.hanoi(...e.parameters))},{name:"Recursive 20",type:"go",factory:()=>new R(e=>window.wasm.go.hanoi(...e.parameters))}],parameters:[20,"A","B","C"],repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Sort",description:"Sort a list of elements containing multiple fields",runners:[{name:"Sort",type:"js",factory:()=>new x},{name:"Sort",type:"rust",factory:()=>new R(e=>window.wasm.rust.sort(...e.parameters))},{name:"Sort",type:"go",factory:()=>new R(e=>window.wasm.go.sort(...e.parameters))}],parameters:[],externalData:{type:"sort",path:"data/users.json",repeat:100},repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Prime numbers",description:"Find primae numbers by using Sieve of Atkin",runners:[{name:"Prime",type:"js",factory:()=>new E},{name:"Prime",type:"rust",factory:()=>new R(e=>window.wasm.rust.prime(...e.parameters))},{name:"Prime",type:"go",factory:()=>new R(e=>window.wasm.go.prime(...e.parameters))}],parameters:[3e6],repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"SHA256",description:"Calculate the SHA256 hash",runners:[{name:"sha256 Forge",type:"js",factory:()=>new z},{name:"sha256 Crypto API",type:"js",factory:()=>new X},{name:"sha256",type:"rust",factory:()=>new R(()=>window.wasm.rust.sha256())},{name:"sha256",type:"go",factory:()=>new R(()=>window.wasm.go.sha256())}],parameters:[],externalData:{type:"bytes",path:"data/random.txt",repeat:100},repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"SHA512",description:"Calculate the SHA512 hash",runners:[{name:"sha512 Forge",type:"js",factory:()=>new K},{name:"sha512 Crypto API",type:"js",factory:()=>new $},{name:"sha512",type:"rust",factory:()=>new R(()=>window.wasm.rust.sha512())},{name:"sha512",type:"go",factory:()=>new R(()=>window.wasm.go.sha512())}],parameters:[],externalData:{type:"bytes",path:"data/random.txt",repeat:100},repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Encryption",description:"Encrypt data using AES",runners:[{name:"AES CBC",type:"js",factory:()=>new C},{name:"AES CBC",type:"rust",factory:()=>new R(()=>window.wasm.rust.aes())},{name:"AES CBC",type:"go",factory:()=>new R(()=>window.wasm.go.aes())}],parameters:[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]],externalData:{type:"bytes",path:"data/random.txt",repeat:100},repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"Compression",description:"Compress data using Deflate",runners:[{name:"Deflate",type:"js",factory:()=>new j},{name:"Deflate",type:"rust",factory:()=>new R(()=>window.wasm.go.deflate())},{name:"Deflate",type:"go",factory:()=>new R(()=>window.wasm.go.deflate())}],parameters:[],externalData:{type:"bytes",path:"data/random.txt",repeat:500},repeat:5,chart:{component:y.a,options:ee},result:[],error:null},{name:"EXIF Reader",description:"exif reader",runners:[{name:"exif",type:"js",factory:()=>new N},{name:"exif",type:"rust",factory:()=>new R(()=>window.wasm.rust.exif())}],parameters:[],externalData:{type:"bytes",path:"data/exif.jpg",repeat:1},repeat:5,chart:{component:y.a,options:ee},showCanvas:!0,canvas:null,result:[],error:null},{name:"Convolution filter",description:"Manipulate an image using a convolution filter",runners:[{name:"convolve",type:"js",factory:()=>new I},{name:"convolve",type:"rust",factory:()=>new T},{name:"convolve",type:"go",factory:()=>new P}],parameters:[],externalData:{type:"image",path:"data/photo.jpg",repeat:1},repeat:5,chart:{component:y.a,options:ee},showCanvas:!0,canvas:null,result:[],error:null},{name:"Video filter",description:"Manipulate a video using a convolution filter",runners:[{name:"convolve video",type:"js",factory:()=>new B},{name:"convolve video",type:"rust",factory:()=>new W},{name:"convolve video",type:"go",factory:()=>new V}],parameters:[],externalData:{type:"video",path:"data/flowers.mp4",repeat:1},repeat:1,chart:{component:y.a,options:Z},showCanvas:!0,canvas:null,video:null,result:[],error:null},{name:"DOM manipulation",description:"Create, add and remove nodes to the documents DOM tree",runners:[{name:"dom",type:"js",factory:()=>new G},{name:"dom",type:"rust",factory:()=>new R(e=>window.wasm.rust.dom(...e.parameters))},{name:"dom",type:"go",factory:()=>new R(e=>window.wasm.go.dom(...e.parameters))}],parameters:[5e3],repeat:5,chart:{component:y.a,options:ee},showCanvas:!0,canvas:null,video:null,result:[],error:null}]};class ae extends s.Component{constructor(...e){super(...e),this.run=()=>{this.props.onRun&&this.props.onRun(this.props)}}fitToParent(e){const t=e.parentElement.clientWidth/e.width;t>1||(e.style.width=e.parentElement.clientWidth+"px",e.style.height=t*e.height+"px")}render(){return r.a.createElement(p.a,null,r.a.createElement(h.a,{as:"h2",floated:"left"},this.props.name,r.a.createElement(h.a.Subheader,null,this.props.description)),r.a.createElement(m.a,{circular:!0,basic:!0,color:"teal",icon:"play circle",content:"Run",onClick:()=>this.run(),floated:"right",disabled:this.props.someRunning,loading:this.props.running}),r.a.createElement(h.a,{as:"h3",style:{clear:"both"}},"Runners"),r.a.createElement(u.a,{horizontal:!0,divided:!0},this.props.runners.map(e=>r.a.createElement(u.a.Item,{key:e.name+"-"+e.type},r.a.createElement(d.a,{avatar:!0,src:te.players[e.type].logo,alt:e.type}),r.a.createElement(u.a.Content,null,r.a.createElement(u.a.Header,null,e.name))))),this.props.canvas?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{as:"h3"},"Canvas"),r.a.createElement("div",{ref:e=>{e&&(e.innerHTML="",e.appendChild(this.props.canvas),this.fitToParent(this.props.canvas),window.addEventListener("resize",()=>this.fitToParent(this.props.canvas),!1))}}),this.props.video?r.a.createElement("div",{ref:e=>{e&&(e.innerHTML="",e.appendChild(this.props.video),this.fitToParent(this.props.video),window.addEventListener("resize",()=>this.fitToParent(this.props.video),!1))}}):null):null,this.props.series&&this.props.series[0].data.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{as:"h3"},"Results"),r.a.createElement(this.props.chart.component,Object.assign({options:this.props.chart.options,series:this.props.series},this.props.chart.options.chart,{height:this.props.chart.options.chart.height*this.props.series.length*this.props.series[0].data.length+100}))):null,this.props.error?r.a.createElement(w.a,{error:!0,header:"Some benchmarks had errors",content:this.props.error instanceof WebAssembly.RuntimeError?this.props.error.stack:this.props.error}):null)}}var se=ae;class re extends s.Component{render(){return r.a.createElement("div",{style:{clear:"both"}},this.props.benchmarks.map(e=>r.a.createElement(se,Object.assign({key:e.name},e,{someRunning:this.props.someRunning,onRun:this.props.onRun}))))}}var ne=re,oe=a(348),ie=a(349),ce=a(350);const le=async e=>{let t=null;if(e){let s;if("image"===e.type?s=new Image:"video"===e.type&&(s=document.createElement("video")),["image","video"].includes(e.type))t=await((e,t)=>{return new Promise((a,s)=>{if(t instanceof HTMLImageElement)t.addEventListener("load",e=>{a(t)},!1),t.src=e;else{if(!(t instanceof HTMLVideoElement))throw new Error("Invalid media type "+typeof t);t.addEventListener("loadeddata",e=>{a(t)},!1),t.src=e,t.load()}t.addEventListener("error",e=>{s(e)},!1)})})(e.path,s);else if("bytes"===e.type){let a=await fetch(e.path),s=await a.arrayBuffer();t=new Uint8Array(s)}else{let s=await fetch(e.path);try{t=await s.clone().json()}catch(a){t=await s.text()}}if(e&&e.repeat>1)if(t instanceof Uint8Array){let a=new Uint8Array(e.repeat*t.length);for(let s=0;s<e.repeat;s++)a.set(t,s*t.length);t=a}else t="object"==typeof t?Array(e.repeat).fill(t).flat():String(t).repeat(e.repeat)}return null!==t&&(e.data=t),e},pe=async(e,t)=>{let a=[],s=[],r=[];await le(e.externalData),((e,t)=>{e&&["sort","bytes"].includes(e.type)&&(t.some(e=>"rust"===e.type)&&window.wasm.rust.prepare_test_data(e.type,e.data),t.some(e=>"go"===e.type)&&window.wasm.go.prepare_test_data(e.type,e.data))})(e.externalData,e.runners);for(let n=0;n<e.runners.length;n++){const o=e.runners[n];r.push(te.players[o.type].color);for(let r=0;r<e.repeat;r++){e.externalData&&e.externalData.type&&("rust"===o.type&&window.wasm.rust.reset_test_data(e.externalData.type),"go"===o.type&&window.wasm.go.reset_test_data(e.externalData.type));let i=o.factory();i.onLoad=t,await i.run(e),a.length<e.repeat&&a.push(r+1),s[n]||(s[n]={name:o.type+": "+o.name,data:[]}),s[n].data.push(i.results())}}return{categories:a,series:s,colors:r}};class he extends s.Component{constructor(e){super(e),this.setStatePromise=e=>new Promise(t=>{this.setState(e,()=>{setTimeout(()=>t(),1)})}),this.onRunAll=async()=>{await this.setStatePromise({running:!0,progress:0,progressTotal:this.props.benchmarks.length});for(let t=0;t<this.state.benchmarks.length;t++)try{await this.setStatePromise({progress:t+1}),await this.onRunBenchmark(this.props.benchmarks[t])}catch(e){console.error(e)}await this.setStatePromise({running:!1})},this.onBenchmarkLoad=async e=>{await this.setStatePromise(t=>{let a=t.benchmarks.filter(t=>t.name===e.name)[0];return Object.assign(a,e),t})},this.onRunBenchmark=async e=>{let t,a;await this.setStatePromise(t=>{return t.benchmarks.filter(t=>t.name===e.name)[0].running=!0,t});try{t=await pe(e,this.onBenchmarkLoad)}catch(s){a=s}return await this.setStatePromise(s=>{let r=s.benchmarks.filter(t=>t.name===e.name)[0];return r.running=!1,t?(r.chart.options.xaxis.categories=t.categories,r.series=t.series,r.chart.options.colors=t.colors):r.error=a||"Unknown error",s}),t},this.state={running:!1,progress:0,progressTotal:0,benchmarks:e.benchmarks}}render(){return r.a.createElement(oe.a,null,r.a.createElement(ie.a,{hidden:!0}),r.a.createElement(h.a,{as:"h1",floated:"left"},"Benchmarks"),r.a.createElement(m.a,{circular:!0,color:"teal",icon:"play circle",content:"Run all benchmarks",floated:"right",loading:this.state.running,onClick:()=>this.onRunAll(),disabled:this.state.running||this.state.benchmarks.some(e=>e.running)}),this.state.running&&this.state.progressTotal?r.a.createElement("div",{style:{clear:"both"}},r.a.createElement(ce.a,{value:this.state.progress,total:this.state.progressTotal,progress:"ratio"})):null,r.a.createElement(ne,{benchmarks:this.state.benchmarks,someRunning:this.state.running||this.state.benchmarks.some(e=>e.running),onRun:this.onRunBenchmark}),r.a.createElement(ie.a,{hidden:!0}))}}var me=he;class ue extends s.Component{constructor(e){super(e),window.wasm={},this.state={loading:!0,error:!1}}componentDidMount(){const e=new window.Go;Promise.all([a.e(3).then(a.bind(null,357)),WebAssembly.instantiateStreaming(fetch("go/webassembly-benchmarks-go.wasm"),Object(i.a)({},e.importObject))]).then(t=>{window.wasm.rust=t[0],e.run(t[1].instance),this.setState({loading:!1})}).catch(e=>this.setState({error:e.message}))}render(){return this.state.error?r.a.createElement(w.a,{error:!0},"Could not start application: ",this.state.error):this.state.loading?r.a.createElement("div",null,"Loading..."):r.a.createElement("main",null,r.a.createElement(c.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/",render:()=>r.a.createElement(me,{benchmarks:te.benchmarks})}),r.a.createElement(l.a,{path:"/test/:id",component:se}))))}}var de=ue;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(342),a(343);o.a.render(r.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})},91:function(e,t){}},[[193,1,2]]]);
//# sourceMappingURL=main.1cf57479.chunk.js.map